<?xml version="1.0" encoding="utf-8" ?>
<local:ImageVariantsDialogBase
    x:Class="MZikmund.App.Dialogs.Admin.ImageVariantsDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:blobs="using:MZikmund.DataContracts.Blobs"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:MZikmund.App.Dialogs.Admin"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:xaml="using:MZikmund.Extensions.Xaml"
    Title="{x:Bind ViewModel.FileName, Mode=OneWay}"
    CloseButtonText="{xaml:Localize Key=Close}"
    Style="{ThemeResource DefaultContentDialogStyle}"
    mc:Ignorable="d">

    <Grid
        Width="400"
        Padding="0"
        RowDefinitions="Auto, Auto, Auto, Auto">

        <!--  Image Preview  -->
        <Border
            Grid.Row="0"
            Height="200"
            Margin="0,0,0,16"
            Background="{ThemeResource LayerFillColorDefaultBrush}"
            CornerRadius="4">
            <Image Margin="8" Stretch="Uniform">
                <Image.Source>
                    <BitmapImage UriSource="{x:Bind ViewModel.SelectedVariantUrl, Mode=OneWay}" />
                </Image.Source>
            </Image>
        </Border>

        <!--  Loading indicator  -->
        <ProgressRing
            Grid.Row="1"
            HorizontalAlignment="Center"
            IsActive="{x:Bind ViewModel.IsLoading, Mode=OneWay}"
            Visibility="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource BoolToVisibilityConverter}}" />

        <!--  Variant selector  -->
        <StackPanel
            Grid.Row="2"
            Margin="0,0,0,16"
            Spacing="8"
            Visibility="{x:Bind ViewModel.IsLoading, Mode=OneWay, Converter={StaticResource InverseBoolToVisibilityConverter}}">
            <TextBlock FontWeight="SemiBold" Text="{xaml:Localize Key=AvailableVariants}" />
            <ListView
                Height="150"
                ItemsSource="{x:Bind ViewModel.AvailableVariants, Mode=OneWay}"
                SelectedItem="{x:Bind ViewModel.SelectedVariant, Mode=TwoWay}">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="blobs:ImageVariant">
                        <Grid Padding="8" ColumnDefinitions="*, Auto">
                            <TextBlock
                                Grid.Column="0"
                                VerticalAlignment="Center"
                                Text="{x:Bind DisplayText}" />
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </StackPanel>

        <!--  Copy URL Button  -->
        <Button
            Grid.Row="3"
            HorizontalAlignment="Stretch"
            Command="{x:Bind ViewModel.CopyUrlCommand}"
            Visibility="{x:Bind ViewModel.SelectedVariant, Mode=OneWay, Converter={StaticResource NullToVisibilityConverter}}">
            <StackPanel Orientation="Horizontal" Spacing="8">
                <SymbolIcon Symbol="Copy" />
                <TextBlock Text="{xaml:Localize Key=CopyUrl}" />
            </StackPanel>
        </Button>
    </Grid>
</local:ImageVariantsDialogBase>
