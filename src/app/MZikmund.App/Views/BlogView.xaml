<?xml version="1.0" encoding="utf-8" ?>
<local:BlogViewBase
    x:Class="MZikmund.Views.BlogView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:local="using:MZikmund.Views"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:MZikmund.DataContracts.Blog"
    xmlns:vmitems="using:MZikmund.ViewModels.Items"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}"
    mc:Ignorable="d">

    <Grid Padding="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0">
            <ItemsRepeater ItemsSource="{x:Bind ViewModel.Posts, Mode=OneWay}">
                <ItemsRepeater.Layout>
                    <UniformGridLayout
                        ItemsStretch="Fill"
                        MinColumnSpacing="16"
                        MinItemHeight="400"
                        MinItemWidth="300"
                        MinRowSpacing="16" />
                </ItemsRepeater.Layout>
                <ItemsRepeater.ItemTemplate>
                    <DataTemplate x:DataType="vmitems:PostListItemViewModel">
                        <Grid
                            Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                            BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                            BorderThickness="1"
                            CornerRadius="{ThemeResource ControlCornerRadius}"
                            PointerEntered="PostCard_PointerEntered"
                            PointerExited="PostCard_PointerExited"
                            PointerPressed="PostCard_PointerPressed"
                            Tag="{x:Bind Item}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="200" />
                                <RowDefinition Height="*" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>

                            <!--  Hero Image  -->
                            <Grid Grid.Row="0" Background="{ThemeResource SystemControlBackgroundBaseLowBrush}">
                                <Image Stretch="UniformToFill" Visibility="{x:Bind Item.HeroImageUrl, Converter={StaticResource NullToVisibilityConverter}, Mode=OneWay}">
                                    <Image.Source>
                                        <BitmapImage UriSource="{x:Bind HeroImageUri, Mode=OneWay}" />
                                    </Image.Source>
                                </Image>
                                <FontIcon
                                    HorizontalAlignment="Center"
                                    VerticalAlignment="Center"
                                    FontSize="72"
                                    Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                    Glyph="&#xE736;"
                                    Visibility="{x:Bind Item.HeroImageUrl, Converter={StaticResource InverseNullToVisibilityConverter}, Mode=OneWay}" />
                            </Grid>

                            <!--  Content  -->
                            <StackPanel
                                Grid.Row="1"
                                Padding="16"
                                Spacing="8">
                                <TextBlock
                                    Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                    Style="{ThemeResource CaptionTextBlockStyle}"
                                    Text="{x:Bind PublishedDate, Mode=OneWay}" />
                                <TextBlock
                                    MaxLines="2"
                                    Style="{ThemeResource SubtitleTextBlockStyle}"
                                    Text="{x:Bind Item.Title, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap" />
                                <TextBlock
                                    Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                                    MaxLines="3"
                                    Style="{ThemeResource BodyTextBlockStyle}"
                                    Text="{x:Bind AbstractPlain, Mode=OneWay}"
                                    TextTrimming="CharacterEllipsis"
                                    TextWrapping="Wrap" />
                            </StackPanel>

                            <!--  Read More  -->
                            <Border Grid.Row="2" Padding="16,0,16,16">
                                <TextBlock
                                    Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"
                                    Style="{ThemeResource BodyTextBlockStyle}"
                                    Text="Read more â†’" />
                            </Border>
                        </Grid>
                    </DataTemplate>
                </ItemsRepeater.ItemTemplate>
            </ItemsRepeater>
        </ScrollViewer>

        <!--  Load More Button  -->
        <StackPanel
            Grid.Row="1"
            Margin="0,16,0,0"
            Spacing="8">
            <Button
                HorizontalAlignment="Center"
                Command="{x:Bind ViewModel.LoadMoreCommand, Mode=OneWay}"
                Content="Load More"
                Visibility="{x:Bind ViewModel.CanLoadMore, Converter={StaticResource BoolToVisibilityConverter}, Mode=OneWay}" />
            <ProgressRing
                HorizontalAlignment="Center"
                IsActive="{x:Bind ViewModel.IsLoadingMore, Mode=OneWay}"
                Visibility="{x:Bind ViewModel.IsLoadingMore, Converter={StaticResource BoolToVisibilityConverter}, Mode=OneWay}" />
            <TextBlock
                HorizontalAlignment="Center"
                Foreground="{ThemeResource SystemControlForegroundBaseMediumBrush}"
                Style="{ThemeResource CaptionTextBlockStyle}"
                Text="{x:Bind ViewModel.TotalCount, Mode=OneWay}" />
        </StackPanel>
    </Grid>
</local:BlogViewBase>
