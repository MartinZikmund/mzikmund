@page "/Blog/{RouteName}"
@using System.Linq
@model MZikmund.Web.Pages.Blog.PostModel

@{
	MetaTags.Title = Model.BlogPost?.Title ?? "";
	MetaTags.Description = Model.BlogPost?.Abstract ?? "";
	MetaTags.Keywords = Model.MetaKeywords;
	if (Model.BlogPost?.HeroImageUrl is { } url)
	{
		MetaTags.Image = url;
	}
	if (Model.BlogPost?.HeroImageAlt is { } alt)
	{
		MetaTags.ImageAlt = alt;
	}
}

@section AboveMain
{
    @await Html.PartialAsync("_PostHero", Model)
}

<div class="blog-post-layout">
    <div class="blog-post-main">
        @await Html.PartialAsync("_PostContent", Model)
    </div>

    <aside id="toc-container">
        <!-- Table of Contents will be generated here by JavaScript -->
    </aside>
</div>

<button class="back-to-top" id="back-to-top" aria-label="Back to top" title="Back to top">
    <i class="bi bi-arrow-up"></i>
</button>

@section Scripts {
    <script>
        (function() {
            var btn = document.getElementById('back-to-top');
            if (!btn) return;
            window.addEventListener('scroll', function() {
                if (window.scrollY > 400) {
                    btn.classList.add('visible');
                } else {
                    btn.classList.remove('visible');
                }
            }, { passive: true });
            btn.addEventListener('click', function() {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        })();
    </script>
}
